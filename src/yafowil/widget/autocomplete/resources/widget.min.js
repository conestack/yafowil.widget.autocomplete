!function(t,e){"use strict";class i{static initialize(t){e("div.yafowil-widget-autocomplete",t).each((function(){let t=e(this);new i(t)}))}constructor(t){this.elem=t,this.input=e("input.autocomplete",this.elem).attr("spellcheck",!1),this.ac_params=e(".autocomplete-params",this.elem),this.ac_source=e(".autocomplete-source",this.elem);let i=this.dd=e("<div />").addClass("autocomplete-dropdown");this.elem.append(i),this.params=[],this.currentFocus=0,this.binder(),this.autocomplete_input=this.autocomplete_input.bind(this),this.input.off("input",this.autocomplete_input).on("input",this.autocomplete_input),this.close_all=this.close_all.bind(this),this.keydown=this.keydown.bind(this),this.input.on("keydown",this.keydown),this.autocomplete_input()}binder(){let t,e,i=this.ac_params.text().split("|"),s=[];for(t=0;t<i.length;t++){let n=i[t].split(","),a=n[1].replace(/^\s+|\s+$/g,"");isNaN(a)||(a=parseInt(a)),"True"===a&&(a=!0),"False"===a&&(a=!1);var o=n[0].replace(/^\s+|\s+$/g,"");"type"===o?e=a:s[o]=a}let n=this.ac_source.text();if(0===n.indexOf("javascript:")){if(n=n.substring(11,n.length),n=n.split("."),!n.length)throw"No source path found.";let e,i=window;for(t in n){if(e=n[t],void 0===i[e])throw"'"+e+"' not found.";i=i[e]}n=i}s.source=n,"local"===e&&(s.source=s.source.split("|")),this.params=s}autocomplete_input(t){this.close_all();let i=this.input.val(),s=this.params.source;if(!i)return!1;this.currentFocus=-1;for(let t=0;t<s.length;t++)if(s[t].substr(0,i.length).toUpperCase()===i.toUpperCase()){let o=e("<span />").addClass("suggestion"),n=e(`<strong>${s[t].substr(0,i.length)}</strong>`),a=e(`<span>${s[t].substr(i.length)}</span>`),l=e('<input type="hidden" />');this.dd.append(o),o.append(n),o.append(a),this.dd.append(l),l.val(s[t]),o.on("click",(()=>{this.input.val(l.val()),this.close_all()}))}}keydown(t){if(console.log(t.key),"ArrowDown"===t.key)this.currentFocus++,this.add_active();else if("ArrowUp"===t.key)this.currentFocus--,this.add_active();else if("Enter"===t.key&&(t.preventDefault(),this.currentFocus>-1)){let t=[];e("span.suggestion",this.dd).each((function(){t.push(e(this))})),t[this.currentFocus].trigger("click")}}add_active(){let t=[];e("span.suggestion",this.dd).each((function(){t.push(e(this))}));for(let e of t)e.removeClass("active");this.currentFocus>=t.length&&(this.currentFocus=0),this.currentFocus<0&&(this.currentFocus=t.length-1),t[this.currentFocus].addClass("active")}close_all(){this.dd.empty()}}e((function(){void 0!==window.ts?ts.ajax.register(i.initialize,!0):void 0!==window.bdajax?bdajax.register(i.initialize,!0):i.initialize()})),t.AutocompleteWidget=i,Object.defineProperty(t,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.autocomplete=t}({},jQuery);
//# sourceMappingURL=widget.min.js.map
